/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./resources/assets/live-edit/live-edit-page-scripts.js":
/*!**************************************************************!*\
  !*** ./resources/assets/live-edit/live-edit-page-scripts.js ***!
  \**************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n\n\n\n\n\nif(window.self !== window.top) {\n\n    mw.require('liveedit.css');\n    mw.require('moveable.js');\n    //mw.require('options.js');\n\n\n     mw.lib.require('tinymce');\n\n\n    mw.liveEditSaveService = {\n        grammarlyFix: function (data) {\n\n            mw.$(\"grammarly-btn\", data).remove();\n            mw.$(\"grammarly-card\", data).remove();\n            mw.$(\"g.gr_\", data).each(function () {\n                mw.$(this).replaceWith(this.innerHTML);\n            });\n            mw.$(\"[data-gramm_id]\", data).removeAttr('data-gramm_id');\n            mw.$(\"[data-gramm]\", data).removeAttr('data-gramm');\n            mw.$(\"[data-gramm_id]\", data).removeAttr('data-gramm_id');\n            mw.$(\"grammarly-card\", data).remove();\n            mw.$(\"grammarly-inline-cards\", data).remove();\n            mw.$(\"grammarly-popups\", data).remove();\n            mw.$(\"grammarly-extension\", data).remove();\n            return data;\n        },\n        saving: false,\n        coreSave: function (data) {\n            if (!data) return false;\n            $.each(data, function () {\n                var body = mw.tools.parseHtml(this.html).body;\n                mw.liveEditSaveService.grammarlyFix(body);\n                mw.liveEditSaveService.animationsClearFix(body);\n                this.html = body.innerHTML;\n            });\n            mw.liveEditSaveService.saving = true;\n\n            /************  START base64  ************/\n            data.from_url = window.location.href;\n\n\n            if(typeof mw.liveEditIframeData !== 'undefined'){\n                //sometimes the url can be modified by pop state, so we use iframedata original url\n                if(typeof mw.liveEditIframeData.content_link !== 'undefined'){\n                    data.from_url =  mw.liveEditIframeData.content_link;\n                }\n\n                //sometimes the lang can be modified from another tab, so we use iframedata original lang\n                if(typeof mw.liveEditIframeData.multiLanguageCurrentLanguage !== 'undefined'){\n                    data.lang = mw.liveEditIframeData.multiLanguageCurrentLanguage;\n                 }\n            }\n\n\n            data = JSON.stringify(data);\n            data = btoa(encodeURIComponent(data).replace(/%([0-9A-F]{2})/g,\n                function toSolidBytes(match, p1) {\n                    return String.fromCharCode('0x' + p1);\n                }));\n            data = {data_base64: data};\n            /************  END base64  ************/\n\n            var xhr = mw.ajax({\n                type: 'POST',\n                url: mw.settings.api_url + 'save_edit',\n                data: data,\n                dataType: \"json\",\n                success: function (saved_data) {\n                    if (saved_data && saved_data.new_page_url && !mw.liveEditSaveService.DraftSaving) {\n                        window.mw.parent().askusertostay = false;\n                        window.mw.askusertostay = false;\n                        window.location.href = saved_data.new_page_url;\n\n                    }\n                }\n            });\n\n            xhr.always(function () {\n                mw.liveEditSaveService.saving = false;\n            });\n            return xhr;\n        },\n        parseContent: function (root) {\n            root = root || document.body;\n            var doc = mw.tools.parseHtml(root.innerHTML);\n            mw.$('.element-current', doc).removeClass('element-current');\n            mw.$('.mce-content-body', doc).removeClass('mce-content-body');\n            mw.$('.mce-content-focus', doc).removeClass('mce-content-focus');\n            mw.$('.element-active', doc).removeClass('element-active');\n            mw.$('.disable-resize', doc).removeClass('disable-resize');\n            mw.$('.mw-module-drag-clone', doc).removeClass('mw-module-drag-clone');\n            mw.$('.ui-draggable', doc).removeClass('ui-draggable');\n            mw.$('.ui-draggable-handle', doc).removeClass('ui-draggable-handle');\n            mw.$('.mt-ready', doc).removeClass('mt-ready');\n            mw.$('.mw-webkit-drag-hover-binded', doc).removeClass('mw-webkit-drag-hover-binded');\n            mw.$('.module-cat-toggle-Modules', doc).removeClass('module-cat-toggle-Modules');\n            mw.$('.mw-module-drag-clone', doc).removeClass('mw-module-drag-clone');\n            mw.$('.mce-edit-focus', doc).removeClass('mce-edit-focus');\n            mw.$('.mce-edit-body', doc).removeClass('mce-edit-body');\n            mw.$('[data-mce-style]', doc).removeAttr('data-mce-style');\n            mw.$('[mce-content-body]', doc).removeAttr('mce-content-body');\n            mw.$('[data-mce-style]', doc).removeAttr('data-mce-style');\n            mw.$('[data-mce-selected]', doc).removeAttr('data-mce-selected');\n            mw.$('[data-mce-href]', doc).removeAttr('data-mce-href');\n            mw.$('-module', doc).removeClass('-module');\n            mw.$('.empty-element', doc).remove();\n            mw.$('.empty-element', doc).remove();\n            mw.$('[data-mce-bogus]', doc).remove();\n            mw.$('.edit .ui-resizable-handle', doc).remove();\n            mw.$('script', doc).remove();\n            mw.$('.moveable-control-box', doc).remove();\n\n\n            //var doc = mw.$(doc).find('script').remove();\n\n            mw.tools.classNamespaceDelete('all', 'ui-', doc, 'starts');\n            mw.$(\"[contenteditable]\", doc).removeAttr(\"contenteditable\");\n            var all = doc.querySelectorAll('[contenteditable]'),\n                l = all.length,\n                i = 0;\n            for (; i < l; i++) {\n                all[i].removeAttribute('contenteditable');\n            }\n            var all = doc.querySelectorAll('.module'),\n                l = all.length,\n                i = 0;\n            for (; i < l; i++) {\n                if (all[i].querySelector('.edit') === null) {\n                    all[i].innerHTML = '';\n                }\n            }\n            return doc;\n        },\n        htmlAttrValidate: function (edits) {\n            var final = [];\n            $.each(edits, function () {\n                var html = this.outerHTML;\n                html = html.replace(/url\\(&quot;/g, \"url('\");\n                html = html.replace(/jpg&quot;/g, \"jpg'\");\n                html = html.replace(/jpeg&quot;/g, \"jpeg'\");\n                html = html.replace(/png&quot;/g, \"png'\");\n                html = html.replace(/gif&quot;/g, \"gif'\");\n                final.push($(html)[0]);\n            })\n            return final;\n        },\n        cleanUnwantedTags: function (body) {\n\n\n            mw.$('.mw-skip-and-remove,script', body).remove();\n            return body;\n        },\n        animationsClearFix: function (body) {\n            mw.$('[class*=\"animate__\"]').each(function () {\n                mw.tools.classNamespaceDelete(this, 'animate__');\n            });\n            return body;\n        },\n        collectData: function (edits) {\n            mw.$(edits).each(function () {\n                mw.$('meta', this).remove();\n                $('.mw-le-spacer', this).empty().removeAttr('data-resizable').removeAttr('style')\n            });\n\n            edits = this.htmlAttrValidate(edits);\n            var l = edits.length,\n                i = 0,\n                helper = {},\n                master = {};\n            if (l > 0) {\n                for (; i < l; i++) {\n                    helper.item = edits[i];\n                    var rel = mw.tools.mwattr(helper.item, 'rel');\n                    if (!rel) {\n                        mw.$(helper.item).removeClass('changed');\n                        mw.tools.foreachParents(helper.item, function (loop) {\n                            var cls = this.className;\n                            var rel = mw.tools.mwattr(this, 'rel');\n                            if (mw.tools.hasClass(cls, 'edit') && mw.tools.hasClass(cls, 'changed') && (!!rel)) {\n                                helper.item = this;\n                                mw.tools.stopLoop(loop);\n                            }\n                        });\n                    }\n                    var rel = mw.tools.mwattr(helper.item, 'rel');\n                    if (!rel) {\n                        var field = !!helper.item.id ? '#' + helper.item.id : '';\n                        console.warn('Skipped save: .edit' + field + ' element does not have rel attribute.');\n                        continue;\n                    }\n                    mw.$(helper.item).removeClass('changed orig_changed');\n                    mw.$(helper.item).removeClass('module-over');\n                    mw.$('.mw-le-ghost-layout', helper.item).remove();\n                    mw.$('#mw-non-existing-temp-element-holder', helper.item).remove();\n\n                    mw.$('.module-over', helper.item).each(function () {\n                        mw.$(this).removeClass('module-over');\n                    });\n\n\n                    mw.$('.element[data-mwplaceholder]', helper.item).each(function () {\n                        var isEmpty = !this.innerHTML.trim();\n                        if (!isEmpty) {\n                            mw.$(this).removeAttr('data-mwplaceholder');\n                        }\n\n                    });\n                    mw.$('.element.lipsum', helper.item).each(function () {\n                        mw.$(this).removeClass('lipsum');\n                    });\n\n                    mw.$('[data-mw-live-edithover]', helper.item).each(function () {\n                        mw.$(this).removeAttr('data-mw-live-edithover');\n                    });\n\n                    mw.$('[data-mw-temp-option-save]', helper.item).each(function () {\n                        mw.$(this).removeAttr('data-mw-temp-option-save');\n                    });\n                    mw.$('[class]', helper.item).each(function () {\n                        var cls = this.getAttribute(\"class\");\n                        if (typeof cls === 'string') {\n                            cls = cls.trim();\n                        }\n                        if (!cls) {\n                            this.removeAttribute(\"class\");\n                        }\n                    });\n                    var content = mw.liveEditSaveService.cleanUnwantedTags(helper.item).innerHTML;\n                    var attr_obj = {};\n                    var attrs = helper.item.attributes;\n                    if (attrs.length > 0) {\n                        var ai = 0,\n                            al = attrs.length;\n                        for (; ai < al; ai++) {\n                            attr_obj[attrs[ai].nodeName] = attrs[ai].nodeValue;\n                        }\n                    }\n                    var obj = {\n                        attributes: attr_obj,\n                        html: content\n                    };\n                    var objdata = \"field_data_\" + i;\n                    master[objdata] = obj;\n                }\n            }\n            return master;\n        },\n        getData: function (root) {\n            var body = mw.liveEditSaveService.parseContent(root).body,\n                edits = body.querySelectorAll('.edit.changed');\n            return mw.liveEditSaveService.collectData(edits);\n        },\n\n        saveDisabled: false,\n        draftDisabled: false,\n        save: function (data, success, fail) {\n            mw.trigger('beforeSaveStart', data);\n            // todo:\n\n            if (mw.top().app) {\n                if (mw.top().app && mw.top().app.cssEditor) {\n\n                    mw.top().app.cssEditor.publishIfChanged();\n                }\n            }\n\n            if (mw.top().app) {\n                if (mw.top().app && mw.top().options) {\n\n                    mw.top().options.publishTempOptions(document);\n                }\n            }\n            if (mw.liveEditSaveService.saveDisabled) {\n                return false;\n            }\n            if (!data) {\n                var body = mw.liveEditSaveService.parseContent().body,\n                    edits = body.querySelectorAll('.edit.changed');\n                data = mw.liveEditSaveService.collectData(edits);\n            }\n\n            var animations = (mw.__pageAnimations || []).filter(function (item) {\n                return item.animation !== 'none';\n            });\n\n            if (animations && animations.length > 0) {\n                var options = {\n                    group: 'template',\n                    key: 'animations-global',\n                    value: JSON.stringify(animations)\n                };\n\n                mw.top().options.saveOption(options);\n                // await new Promise(resolve =>  {\n                //     mw.options.saveOption(options, function(){\n                //         resolve();\n                //     });\n                // });\n            }\n\n\n            if (mw.tools.isEmptyObject(data)) {\n                if (success) {\n                    success.call({})\n                }\n                return false;\n            }\n\n\n            mw._liveeditData = data;\n\n            mw.trigger('saveStart', mw._liveeditData);\n\n            var xhr = mw.liveEditSaveService.coreSave(mw._liveeditData);\n            xhr.error(function (sdata) {\n\n                if (xhr.status == 403) {\n                    var modal = mw.dialog({\n                        id: 'save_content_error_iframe_modal',\n                        html: \"<iframe id='save_content_error_iframe' style='overflow-x:hidden;overflow-y:auto;' class='mw-modal-frame' ></iframe>\",\n                        width: $(window).width() - 90,\n                        height: $(window).height() - 90\n                    });\n\n                    mw.askusertostay = false;\n\n                    mw.$(\"#save_content_error_iframe\").ready(function () {\n                        var doc = document.getElementById('save_content_error_iframe').contentWindow.document;\n                        doc.open();\n                        doc.write(xhr.responseText);\n                        doc.close();\n                        var save_content_error_iframe_reloads = 0;\n                        doc = document.getElementById('save_content_error_iframe').contentWindow.document;\n\n                        mw.$(\"#save_content_error_iframe\").load(function () {\n                            // cloudflare captcha\n                            var is_cf = mw.$('.challenge-form', doc).length;\n                            save_content_error_iframe_reloads++;\n\n                            if (is_cf && save_content_error_iframe_reloads == 2) {\n                                setTimeout(function () {\n                                    mw.askusertostay = false;\n                                    mw.$('#save_content_error_iframe_modal').remove();\n                                }, 150);\n\n                            }\n                        });\n\n                    });\n                }\n                if (fail) {\n                    fail.call(sdata)\n                }\n            });\n            xhr.success(function (sdata) {\n                mw.$('.edit.changed').removeClass('changed');\n                mw.$('.orig_changed').removeClass('orig_changed');\n                if (document.querySelector('.edit.changed') !== null) {\n                    mw.liveEditSaveService.save();\n                } else {\n                    mw.askusertostay = false;\n                    mw.trigger('saveEnd', sdata);\n                }\n                if (success) {\n                    success.call(sdata)\n                }\n\n            });\n            xhr.fail(function (jqXHR, textStatus, errorThrown) {\n                mw.trigger('saveFailed', textStatus, errorThrown);\n                if (fail) {\n                    fail.call(sdata)\n                }\n            });\n            return xhr;\n        },\n\n    };\n\n    mw.saveLiveEdit = async () => {\n        return new Promise((resolve) => {\n            mw.liveEditSaveService.save(undefined, () => resolve(true), () => resolve(false));\n        })\n    };\n\n    mw.top().app.save = async () => {\n\n        return await mw.saveLiveEdit()\n    };\n\n\n    addEventListener('load', () => {\n\n        window.addEventListener('keydown', function (event) {\n            mw.top().app.canvas.dispatch('iframeKeyDown', {event})\n        });\n\n\n        mw.$('span.mw-powered-by').on(\"click\", function (e) {\n            mw.top().tools.open_global_module_settings_modal('white_label/admin', 'mw-powered-by');\n            return false;\n        });\n\n\n        const _handleEmptyEditFields = function () {\n\n            function manageNode(node) {\n                const isEmptyLike = !node.innerHTML.trim();\n\n                if (isEmptyLike && node.innerHTML.trim() === node.textContent.trim()) {\n                    // mw.element(node).append(`<p class=\"element\" data-mwplaceholder=\"${mw.lang(`This is sample text for your page`)}\"></p>`);\n                } else {\n                    node.classList[isEmptyLike ? 'add' : 'remove']('mw-le-empty-element');\n                }\n            }\n\n            document.querySelectorAll('.edit').forEach(function (node) {\n                if (!node.__$$_handleEmptyEditFields) {\n                    node.__$$_handleEmptyEditFields = true;\n                    manageNode(node);\n                    node.addEventListener('input', function () {\n                        manageNode(this);\n                    });\n                }\n            });\n\n            mw.top().app.on('editChanged', edit => {\n                setTimeout(() => manageNode(edit));\n            })\n        };\n\n        _handleEmptyEditFields()\n\n\n    });\n\n\n    let _beforeUnload = null;\n\n    mw.top().app.isNavigating = () => {\n        return !!_beforeUnload && _beforeUnload.returnValue && _beforeUnload.defaultPrevented === true\n    };\n\n\n    self.onbeforeunload = function (event) {\n        _beforeUnload = event;\n\n        // prevent user from leaving if there are unsaved changes\n         var liveEditIframe = self;\n\n       // var liveEditIframe = mw.top().app.canvas.getWindow();\n\n        liveEditIframe.mw.isNavigating = true;\n        if( typeof(mw.top) === 'function' && mw.top().app.canvas) {\n            mw.top().app.canvas.dispatch('liveEditCanvasBeforeUnload');\n        }\n\n        setTimeout(function (liveEditIframe) {\n            if (liveEditIframe) {\n                if (liveEditIframe && liveEditIframe.mw) {\n                    liveEditIframe.mw.isNavigating = false;\n                }\n            }\n        }, 1, liveEditIframe);\n\n\n        if (liveEditIframe\n            && liveEditIframe.mw && liveEditIframe.mw.askusertostay) {\n            return true;\n        } else {\n            if( typeof(mw.top) === 'function' && mw.top().app.canvas) {\n                var frame = mw.top().app.canvas.getFrame();\n                if (frame && frame.parentElement) {\n                    mw.top().spinner({element: frame.parentElement, decorate: true, size: 52}).show()\n                }\n            }\n        }\n    };\n\n\n    mw.drag = mw.drag || {};\n    mw.drag.save = function () {\n        return mw.liveEditSaveService.save();\n    };\n    mw.drag.fix_placeholders = function (isHard, selector) {\n        selector = selector || '.edit .row';\n\n        var more_selectors2 = 'div.col-md';\n        var a = mw.top().app.templateSettings.helperClasses.external_grids_col_classes;\n        var index;\n        for (index = a.length - 1; index >= 0; --index) {\n            more_selectors2 += ',div.' + a[index];\n        }\n        mw.$(selector).each(function () {\n            var el = mw.$(this);\n            el.children(more_selectors2).each(function () {\n                var empty_child = mw.$(this).children('*');\n                if (empty_child.length == 0) {\n                    mw.$(this).append('<div class=\"element\" id=\"mw-element-' + mw.random() + '\">' + '</div>');\n                    var empty_child = mw.$(this).children(\"div.element\");\n                }\n            });\n        });\n\n    };\n\n    mw.drag.module_settings = function () {\n        var target = mw.top().app.liveEdit.moduleHandle.getTarget();\n        return mw.top().app.editor.dispatch('onModuleSettingsRequest', target);\n    };\n\n\n    document.documentElement.addEventListener('click', function (event) {\n\n        var target = event.target;\n        var link = mw.tools.firstParentOrCurrentWithTag(target, 'a');\n\n        if (link && link.href.indexOf('javascript:') !== 0 && !link.isContentEditable) {\n            const tmp = document.createElement('a');\n            tmp.href = link.href;\n            if (tmp.host !== location.host && (!link.target || link.target === '_self')) {\n                event.preventDefault();\n                open(link.href);\n            }\n        }\n\n    })\n    document.addEventListener('keydown', function (event) {\n        if (event.ctrlKey && event.keyCode === 83) {\n            return mw.top().app.editor.dispatch('Ctrl+S', event);\n        }\n    });\n\n\n    document.body.addEventListener('mouseenter', function (event) {\n        $('body').removeClass('mw-live-body-mouse-moved-outside');\n\n    });\n\n\n    document.body.addEventListener('mouseleave', function (event) {\n        $('body').addClass('mw-live-body-mouse-moved-outside');\n    });\n\n}\nif (self === top) {\n    window.addEventListener(\"load\", (event) => {\n        if (window.mwLiveEditIframeBackUrl) {\n            // Create the <a> element (button)\n            var stickyButton = document.createElement('a');\n            stickyButton.id = 'back-to-live-sticky-button';\n            stickyButton.textContent = 'Go Live Edit';\n            stickyButton.href = window.mwLiveEditIframeBackUrl;\n            stickyButton.classList.add('sticky');\n\n            // Append the button to the document body\n            document.body.appendChild(stickyButton);\n\n            // Apply sticky behavior\n            stickyButton.classList.add('sticky');\n\n\n\n            // Create and apply the CSS style dynamically\n            var style = document.createElement('style');\n            style.textContent = `\n                    #back-to-live-sticky-button {\n                        position: fixed;\n                        left: 50%;\n                        transform: translateX(-50%);\n                        z-index: 1001;\n                        transition: top 0.3s;\n                        background: #3498db;\n                        color: #fff !important;\n                        padding: 10px 20px;\n                        border-radius: 5px;\n                        border-top-left-radius: 0;\n                        border-top-right-radius: 0;\n                        font-family: Arial, sans-serif;\n                        border: none;\n                        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n                        cursor: pointer;\n                    }\n\n                    #back-to-live-sticky-button:hover {\n                        background: #2980b9;\n                    }\n\n\n                    #back-to-live-sticky-button.sticky {\n                        top: 0;\n                    }\n\n\n\n\n            `;\n\n            document.head.appendChild(style);\n        }\n\n        // todo: remove\n        document.querySelectorAll('.no-select [class*=\"col\"]').forEach(function(node){\n            if(Array.from(node.children).filter(c => c.classList.contains('element')).length) {\n                node.classList.add('allow-select')\n            }\n        });\n    });\n}\n\n\n\n\n\n//# sourceURL=webpack://microweber-frontend-assets/./resources/assets/live-edit/live-edit-page-scripts.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The require scope
/******/ 	var __webpack_require__ = {};
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./resources/assets/live-edit/live-edit-page-scripts.js"](0, __webpack_exports__, __webpack_require__);
/******/ 	
/******/ })()
;